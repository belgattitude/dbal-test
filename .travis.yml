language: php
sudo: false

php:
  - 7.1

addons:
  mariadb: '10.2'

before_script:
  - mysql -e 'CREATE DATABASE doctrine_test_6790;'
  - composer self-update
  - composer install --dev --prefer-dist --no-interaction

script:
  - php bin/console doctrine:database:drop -n --force
  - php bin/console doctrine:database:create -n
  - php bin/console doctrine:schema:update --force
  # Should not return differences
  - php bin/console doctrine:schema:update --dump-sql
  # Should not return any diff
  - php bin/console doctrine:migrations:diff
  #- php bin/console doctrine:schema:validate -n

cache:
  directories:
    - $COMPOSER_CACHE_DIR

